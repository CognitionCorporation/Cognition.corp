"use strict";var FrontEndApp=angular.module("FrontEndApp",["rzModule","chart.js"]);FrontEndApp.directive("printCheckbox",function(){return{restrict:"E",scope:!0,controller:["$scope",function(e){e.callCheckChanged=function(t){for(var a=0;a<e.$parent.checkboxModels.length&&e.$parent.checkboxModels[a].category!==e.checkboxModel.category;a++);if(t.isSelected)e.$parent.checkboxModels[a].appliedFilter.push(t.name);else{var i=e.$parent.checkboxModels[a].appliedFilter.indexOf(t.name);e.$parent.checkboxModels[a].appliedFilter.splice(i,1)}}}],template:'<form name="checkboxForm"><h3>{{ checkboxModel.category }}</h3><div ng-class="{highlight: hover, unhighlight: !hover}" ng-mouseenter="hover = true" ng-mouseleave="hover = false" ng-repeat="box in checkboxModel.data"><label><input type="checkbox" ng-model="box.isSelected" ng-change="callCheckChanged(box)">{{ box.name }}</label></div></form>'}}),FrontEndApp.controller("CheckboxController",["$scope","$http","LoadViewService","GlobalStateUI",function(e,t,a,i){function n(e){return e?1:0}var r=a.callbackParseSelection;e.loadMoreOrgs=function(){e.loadStatus.isLoading=!0,e.slider_bar_max.value>0&&e.slider_bar_min.value>e.slider_bar_max.value&&(e.slider_bar_max.value=e.slider_bar_min.value);var a=null;e.slider_bar_min.value>1&&(a=e.slider_bar_min.value.toString());var i=null;e.slider_bar_max.value>0&&(i=e.slider_bar_max.value.toString());var o=null;e.sortStatus.nameAscending?o="up":e.sortStatus.nameDescending&&(o="down");var s=null;e.sortStatus.sizeAscending?s="up":e.sortStatus.sizeDescending&&(s="down");var l=null;e.sortStatus.mainAscending?l="up":e.sortStatus.mainDescending&&(l="down");var c=null;e.sortStatus.growthAscending?c="up":e.sortStatus.growthDescending&&(c="down");var d=0;e.focusFilterType.restrictToPrimary&&(d=1),t.get("/OrgFinder/backEnd/selects.php",{params:{pagenum:e.orgResults.nextPage,primary:d,NameOrSID:encodeURI(e.filterName),Manifesto:encodeURI(e.filterManifesto),nameDir:o,sizeDir:s,mainDir:l,Growth:c,Min:a,Max:i,Cog:n(e.Cog),OPPF:n(e.OPPF),STAR:n(e.STAR),Reddit:n(e.Reddit),Lang:e.language,Activity:e.checkboxModels[0].appliedFilter.toString(),Archetype:e.checkboxModels[4].appliedFilter.toString(),Commitment:e.checkboxModels[1].appliedFilter.toString(),Recruiting:e.checkboxModels[2].appliedFilter.toString(),Roleplay:e.checkboxModels[3].appliedFilter.toString()}}).success(r),e.orgResults.nextPage++},e.StateUI=i.StateUI,e.pageSize=12,e.Cog=!1,e.OPPF=!1,e.STAR=!1,e.Reddit=!1,e.clearResults=a.clearResults,e.focusFilterType=a.focusFilterType,e.sortStatus=a.sortStatus,e.loadStatus=a.loadStatus,e.orgResults=a.orgResults,e.reapplyFilters=function(){e.clearResults(),e.loadMoreOrgs()},e.resetFilters=function(){for(var t in e.checkboxModels){e.checkboxModels[t].appliedFilter.length=0;for(var a in e.checkboxModels[t].data)e.checkboxModels[t].data[a].isSelected=!1}e.Cog=!1,e.OPPF=!1,e.STAR=!1,e.Reddit=!1,e.slider_bar_min.value=1,e.slider_bar_max.value=0,e.language="Any",e.filterName="",e.filterManifesto=""},e.checkboxModels=[],e.language="Any",e.filterName="",e.filterManifesto="",e.slider_bar_min={value:1,options:{floor:1,ceil:100,step:1,showSelectionBar:!0,getSelectionBarColor:function(e){return e<=15?"red":e<=30?"orange":e<=45?"yellow":"#2AE02A"}}},e.slider_bar_max={value:0,options:{floor:0,ceil:100,step:1,showSelectionBar:!0,getSelectionBarColor:function(e){return e<=20?"red":e<=40?"orange":e<=60?"yellow":"#2AE02A"}}},e.iconsObj=a.icons,e.langs=["Abkhazian","Amharic","Afar","Afrikaans","Akan","Albanian","Arabic","Aragonese","Armenian","Assamese","Avaric","Avestan","Aymara","Azerbaijani","Bambara","Bashkir","Basque","Belarusian","Bengali","Bihari languages","Bislama","Bokmål, Norwegian","Bosnian","Breton","Bulgarian","Burmese","Catalan","Central Khmer","Chamorro","Chechen","Chichewa","Chinese","Church Slavic","Chuvash","Cornish","Corsican","Cree","Croatian","Czech","Danish","Dutch","Dzongkha","English","Esperanto","Estonian","Ewe","Faroese","Fijian","Finnish","French","Fulah","Gaelic","Galician","Ganda","Georgian","German","Greek, Modern","Guarani","Gujarati","Haitian Creole","Hausa","Hebrew","Herero","Hindi","Hiri Motu","Hungarian","Icelandic","Ido","Igbo","Indonesian","Interlingua","Interlingue","Inuktitut","Inupiaq","Irish","Italian","Japanese","Javanese","Kalaallisut","Kannada","Kanuri","Kashmiri","Kazakh","Kikuyu","Kinyarwanda","Kirghiz","Komi","Kongo","Korean","Kuanyama","Kurdish","Lao","Luba-Katanga","Latin","Latvian","Limburgan","Lingala","Lithuanian","Luxembourgish","Macedonian","Malagasy","Malay","Malayalam","Maldivian","Maltese","Manx","Maori","Marathi","Marshallese","Mongolian","Nauru","Navajo","Ndebele, North","Ndebele, South","Ndonga","Nepali","Northern Sami","Norwegian","Nynorsk, Norwegian","Occitan","Ojibwa","Oriya","Oromo","Ossetian","Pali","Panjabi","Persian","Polish","Portuguese","Pushto","Quechua","Romanian","Romansh","Rundi","Russian","Samoan","Sango","Sanskrit","Sardinian","Serbian","Shona","Sichuan Yi","Sindhi","Sinhala","Slovak","Slovenian","Somali","Sotho, Southern","Spanish","Sundanese","Swahili","Swati","Swedish","Tagalog","Tahitian","Tajik","Tamil","Tatar","Telugu","Thai","Tibetan","Tigrinya","Tonga","Tsonga","Tswana","Turkish","Turkmen","Twi","Uighur","Ukrainian","Urdu","Uzbek","Venda","Vietnamese","Volapük","Walloon","Welsh","Western Frisian","Wolof","Xhosa","Yiddish","Yoruba","Zhuang","Zulu"];var o=[{category:"Activities",data:[{name:"Bounty Hunting",isSelected:!1},{name:"Engineering",isSelected:!1},{name:"Exploration",isSelected:!1},{name:"Freelancing",isSelected:!1},{name:"Infiltration",isSelected:!1},{name:"Piracy",isSelected:!1},{name:"Resources",isSelected:!1},{name:"Scouting",isSelected:!1},{name:"Security",isSelected:!1},{name:"Smuggling",isSelected:!1},{name:"Social",isSelected:!1},{name:"Trading",isSelected:!1},{name:"Transport",isSelected:!1}]},{category:"Commitment",data:[{name:"Casual",isSelected:!1},{name:"Regular",isSelected:!1},{name:"Hardcore",isSelected:!1}]},{category:"Recruiting",data:[{name:"Yes",isSelected:!1},{name:"No",isSelected:!1}]},{category:"Roleplay",data:[{name:"Yes",isSelected:!1},{name:"No",isSelected:!1}]},{category:"Archetype",data:[{name:"Organization",isSelected:!1},{name:"Corporation",isSelected:!1},{name:"PMC",isSelected:!1},{name:"Faith",isSelected:!1},{name:"Syndicate",isSelected:!1}]}];for(var s in o)e.checkboxModels.push({category:o[s].category,appliedFilter:[],data:o[s].data});e.loadMoreOrgs(),e.toggleView=function(){e.StateUI.listViewTF?e.StateUI.listViewTF=!1:e.StateUI.listViewTF=!0},e.$on("loadMoreOrgs",e.loadMoreOrgs)}]),FrontEndApp.factory("GlobalStateUI",function(){var e={Controls:!0,Details:!1,listViewTF:!0};return{StateUI:e}}),angular.module("FrontEndApp").controller("DetailsController",["$scope","LoadDetailsService","GlobalStateUI",function(e,t,a){e.exitDetails=function(){if(e.StateUI.Details=!1,e.StateUI.Controls=!0,!e.StateUI.listViewTF){var t=document.getElementById("grid-view-results").offsetWidth,a=document.getElementById("cellWidthJS").offsetWidth;e.gridWidthModifer.data={width:(t+a).toString()+"px"}}},e.StateUI=a.StateUI,e.widthDetails=t.widthDetails,e.gridWidthModifer=t.gridWidthModifer,e.config=t.config,e.chartData=t.chartData,e.rowData=t.rowData,e.loadDetails=t.loadDetails,Chart.defaults.global.defaultFontColor="#ffffff",Chart.defaults.global.defaultFontSize=18,e.colourConfig={colours:["#FFFFFF","#FFA500","#88FF00","#FF0000"]}}]),FrontEndApp.factory("LoadDetailsService",["$http",function(e){function t(e,t){var a=Math.floor(t/7);return e-a-1}function a(e,a){var i=e,r=0,o=0,s=!0,l=[];for(l.push(i.toString());i>a;i=r){for(r=t(i,e),r<0&&(s=!1,r=0),o=i-r-1;o>0;--o)l.push("");s?l.push(r.toString()):l.push("")}n.labels=l}function i(e,t,a){var i=(t-e)/a;return i+e}var n={series:["Size","Main","Affiliate","Hidden"],labels:[],options:{elements:{line:{fill:!1,borderWidth:4}},responsive:!0,legend:{display:!0,position:"top",fullWidth:!0,labels:{fontColor:"#FFFFFF",fontStyle:"bold",fontSize:20,boxWidth:50}},scales:{yAxes:[{gridLines:{color:"rgba(255,255,255,1.0)",drawOnChartArea:!1,zeroLineWidth:2},ticks:{suggestedMin:0,stepSize:1,callback:function(e,t,a){if(!(t%parseInt(a.length/5)))return e}}}],xAxes:[{gridLines:{color:"rgba(255,255,255,1.0)",drawOnChartArea:!1,drawTicks:!1}}]}}},r={plots:[]},o={result:{}},s=function(e){var t=e[0].DaysAgo;a(t,e[e.length-1].DaysAgo);var n=[],o=[],s=[],l=[],c={Size:0,Main:0,Affiliate:0,Hidden:0,lastDay:e[0].DaysAgo};for(var d in e){for(var g=e[d].DaysAgo;t!==g&&t>=0;)c.Size=i(c.Size,e[d].Size,c.lastDay-g),c.Main=i(c.Main,e[d].Main,c.lastDay-g),c.Affiliate=i(c.Affiliate,e[d].Affiliate,c.lastDay-g),c.Hidden=i(c.Hidden,e[d].Hidden,c.lastDay-g),n.push(c.Size),o.push(c.Main),s.push(c.Affiliate),l.push(c.Hidden),c.lastDay=t,--t;n.push(e[d].Size),o.push(e[d].Main),s.push(e[d].Affiliate),l.push(e[d].Hidden),c.Size=e[d].Size,c.Main=e[d].Main,c.Affiliate=e[d].Affiliate,c.Hidden=e[d].Hidden,c.lastDay=t,--t}r.plots=[n,o,s,l]},l=function(e){document.getElementById("org-greeting").innerHTML=e[0].Headline,document.getElementById("org-manifesto").innerHTML=e[0].Manifesto},c=function(t){o.result=t,e.get("/OrgFinder/backEnd/org_history.php",{params:{SID:t.SID}}).success(s),e.get("/OrgFinder/backEnd/org_description.php",{params:{SID:t.SID}}).success(l)},d={data:{width:"100px"}},g={data:{width:document.getElementById("grid-view-results").offsetWidth.toString()+"px"}};return{config:n,chartData:r,rowData:o,loadDetails:c,widthDetails:d,gridWidthModifer:g}}]),FrontEndApp.factory("LoadViewService",function(){function e(){r.nameDouble=!0,r.nameAscending=!1,r.nameDescending=!1,r.sizeDouble=!0,r.sizeAscending=!1,r.sizeDescending=!1,r.mainDouble=!0,r.mainAscending=!1,r.mainDescending=!1,r.growthDouble=!0,r.growthAscending=!1,r.growthDescending=!1}function t(e){if("null\n"===e)console.log(e),console.log("No more orgs found!\n"),alert("No more orgs found!\n");else{var t="";Object.keys(e).forEach(function(n){t=1===e[n].CustomIcon?"/org_icons/"+e[n].SID:"frontEnd/org_icons_default/"+e[n].Archetype+".jpg",a.results.push({SID:e[n].SID,Name:e[n].Name,Size:e[n].Size,Main:e[n].Main,Icon:t,URL:"https://robertsspaceindustries.com/orgs/"+e[n].SID,GrowthRate:e[n].GrowthRate.toFixed(1),Commitment:e[n].Commitment,Recruiting:e[n].Recruiting,Language:e[n].Language,Roleplay:e[n].Roleplay,Archetype:e[n].Archetype,PrimaryFocus:e[n].PrimaryFocus,SecondaryFocus:e[n].SecondaryFocus,PrimaryIcon:i.icons[e[n].PrimaryFocus],SecondaryIcon:i.icons[e[n].SecondaryFocus]})})}o.isLoading=!1}var a={results:[],nextPage:0},i={icons:{"Bounty Hunting":"/OrgFinder/frontEnd/images/activities/Bounty_hunting.png",Engineering:"/OrgFinder/frontEnd/images/activities/Engineering.png",Exploration:"/OrgFinder/frontEnd/images/activities/Exploration.png",Freelancing:"/OrgFinder/frontEnd/images/activities/Freelancing.png",Infiltration:"/OrgFinder/frontEnd/images/activities/Infiltration.png",Piracy:"/OrgFinder/frontEnd/images/activities/Piracy.png",Resources:"/OrgFinder/frontEnd/images/activities/Resources.png",Scouting:"/OrgFinder/frontEnd/images/activities/Scouting.png",Security:"/OrgFinder/frontEnd/images/activities/Security.png",Smuggling:"/OrgFinder/frontEnd/images/activities/Smuggling.png",Social:"/OrgFinder/frontEnd/images/activities/Social.png",Trading:"/OrgFinder/frontEnd/images/activities/Trade.png",Transport:"/OrgFinder/frontEnd/images/activities/Transport.png"}},n=function(){a.results=[],a.nextPage=0},r={nameDouble:!0,nameAscending:!1,nameDescending:!1,sizeDouble:!0,sizeAscending:!1,sizeDescending:!1,mainDouble:!0,mainAscending:!1,mainDescending:!1,growthDouble:!1,growthAscending:!1,growthDescending:!0},o={isLoading:!1},s={restrictToPrimary:!1};return{callbackParseSelection:t,orgResults:a,loadStatus:o,focusFilterType:s,sortStatus:r,clearSorting:e,clearResults:n,icons:i}}),FrontEndApp.controller("ViewController",["$scope","$rootScope","LoadViewService","LoadDetailsService","GlobalStateUI",function(e,t,a,i,n){e.loadMoreOrgs=function(){t.$broadcast("loadMoreOrgs")},e.loadDetails=function(t){var a=0,n=0;e.StateUI.listViewTF?0!==document.getElementById("commitment-language").offsetWidth&&(a=document.getElementById("raw-block-width").offsetWidth,n=document.getElementById("commitment-language").offsetWidth,e.widthDetails.data={width:(n+a).toString()+"px"}):((a=0!==document.getElementById("left-block-controls").offsetWidth)&&(a=document.getElementById("left-block-controls").offsetWidth,n=document.getElementById("cellWidthJS").offsetWidth,e.widthDetails.data={width:(n+a).toString()+"px"}),e.StateUI.Details||(a=document.getElementById("grid-view-results").offsetWidth,e.gridWidthModifer.data={width:(a-n).toString()+"px"})),e.curSelection=t.SID,i.loadDetails(t),e.StateUI.Details=!0,e.StateUI.Controls=!1},e.clearResults=a.clearResults,e.StateUI=n.StateUI,e.focusFilterType=a.focusFilterType,e.sortstatus=a.sortStatus,e.clearSorting=a.clearSorting,e.loadStatus=a.loadStatus,e.orgResults=a.orgResults,e.curSelection="",e.clickName=function(){e.sortstatus.nameDouble?(e.clearSorting(),e.sortstatus.nameDouble=!1,e.sortstatus.nameAscending=!0):e.sortstatus.nameAscending?(e.clearSorting(),e.sortstatus.nameDouble=!1,e.sortstatus.nameDescending=!0):e.sortstatus.nameDescending&&e.clearSorting(),e.clearResults(),e.loadMoreOrgs()},e.clickSize=function(){e.sortstatus.sizeDouble?(e.clearSorting(),e.sortstatus.sizeDouble=!1,e.sortstatus.sizeDescending=!0):e.sortstatus.sizeDescending?(e.clearSorting(),e.sortstatus.sizeDouble=!1,e.sortstatus.sizeAscending=!0):e.sortstatus.sizeAscending&&e.clearSorting(),e.clearResults(),e.loadMoreOrgs()},e.clickMain=function(){e.sortstatus.mainDouble?(e.clearSorting(),e.sortstatus.mainDouble=!1,e.sortstatus.mainDescending=!0):e.sortstatus.mainDescending?(e.clearSorting(),e.sortstatus.mainDouble=!1,e.sortstatus.mainAscending=!0):e.sortstatus.mainAscending&&e.clearSorting(),e.clearResults(),e.loadMoreOrgs()},e.clickGrowth=function(){e.sortstatus.growthDescending?(e.clearSorting(),e.sortstatus.growthDouble=!1,e.sortstatus.growthAscending=!0):e.sortstatus.growthAscending?e.clearSorting():e.sortstatus.growthDouble&&(e.clearSorting(),e.sortstatus.growthDouble=!1,e.sortstatus.growthDescending=!0),e.clearResults(),e.loadMoreOrgs()},e.focusFilterTypeToggle=function(){e.focusFilterType.restrictToPrimary?e.focusFilterType.restrictToPrimary=!1:e.focusFilterType.restrictToPrimary=!0},e.widthDetails=i.widthDetails,e.gridWidthModifer=i.gridWidthModifer}]);